publicGetCategories:
    handler: src/categories/lambda/public/getCategories.handler
    timeout: 29
    events:
        - http:
              path: /v1/categories/public
              method: GET
              cors: true
    vpc:
        securityGroupIds:
            - !Ref ProxySecurityGroup
        subnetIds:
            - !Ref PrivateSubnetA
            - !Ref PrivateSubnetB
    environment:
        RDS_PROXY_ENDPOINT: !GetAtt PostgresRDSProxy.Endpoint
        POSTGRES_DB: ${self:custom.resourceNames.postgresDB}
        POSTGRES_USERNAME: ${env:POSTGRES_USERNAME}
        USE_RDS_PROXY: true

getCategories:
    handler: src/categories/lambda/authenticated/getCategories.handler
    timeout: 29
    events:
        - http:
              path: /v1/categories
              method: GET
              cors: true
              authorizer:
                  type: COGNITO_USER_POOLS
                  authorizerId: { Ref: ApiGatewayAuthorizer }
    vpc:
        securityGroupIds:
            - !Ref ProxySecurityGroup
        subnetIds:
            - !Ref PrivateSubnetA
            - !Ref PrivateSubnetB
    environment:
        RDS_PROXY_ENDPOINT: !GetAtt PostgresRDSProxy.Endpoint
        POSTGRES_DB: ${self:custom.resourceNames.postgresDB}
        POSTGRES_USERNAME: ${env:POSTGRES_USERNAME}
        USE_RDS_PROXY: true
